{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "MAID Task Manifest",
    "type": "object",
    "required": ["goal", "readonlyFiles", "expectedArtifacts"],
    "anyOf": [
      { "required": ["validationCommand"] },
      { "required": ["validationCommands"] }
    ],
    "properties": {
      "version": {
        "type": "string",
        "enum": ["1"],
        "description": "Schema version (defaults to '1' if not specified). Currently only version '1' is supported.",
        "default": "1"
      },
      "goal": { "type": "string" },
      "taskType": { "type": "string" },
      "supersedes": { "type": "array", "items": { "type": "string" }, "description": "Paths to manifests that this one replaces/obsoletes" },
      "creatableFiles": { "type": "array", "items": { "type": "string" } },
      "editableFiles": { "type": "array", "items": { "type": "string" } },
      "readonlyFiles": { "type": "array", "items": { "type": "string" } },
      "metadata": {
        "type": "object",
        "properties": {
          "author": { "type": "string" },
          "created": { "type": "string" },
          "tags": { "type": "array", "items": { "type": "string" } },
          "priority": { "type": "string" }
        },
        "additionalProperties": false
      },
      "expectedArtifacts": {
        "type": "object",
        "properties": {
          "file": { "type": "string" },
          "contains": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "type": { "enum": ["class", "function", "attribute", "parameter"] },
                "name": { "type": "string" },
                "description": { "type": "string", "description": "Optional description of what this artifact does" },
                "artifactKind": { "type": "string", "description": "Optional semantic kind of artifact (e.g., 'type', 'interface', 'utility')" },
                "class": { "type": "string", "description": "The parent class for attributes or methods" },
                "bases": { "type": "array", "items": { "type": "string" }, "description": "The base classes for a class (optional)" },
                "function": { "type": "string", "description": "The parent function for parameters" },
                "parameters": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": { "type": "string" },
                      "type": { "type": "string" }
                    },
                    "required": ["name"],
                    "additionalProperties": false
                  },
                  "description": "List of parameter names for a function (legacy format)"
                },
                "args": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": { "type": "string" },
                      "type": { "type": "string" },
                      "default": { "type": "string" }
                    },
                    "required": ["name"],
                    "additionalProperties": false
                  },
                  "description": "List of function arguments (enhanced format)"
                },
                "returns": {
                  "anyOf": [
                    { "type": "string", "description": "The return type of a function (string format)" },
                    {
                      "type": "object",
                      "properties": {
                        "type": { "type": "string" }
                      },
                      "required": ["type"],
                      "additionalProperties": false,
                      "description": "The return type of a function (object format)"
                    }
                  ],
                  "description": "The return type of a function (optional)"
                },
                "raises": {
                  "type": "array",
                  "items": { "type": "string" },
                  "description": "List of exception types that may be raised (optional)"
                }
              },
              "required": ["type", "name"],
              "additionalProperties": false
            }
          }
        },
        "required": ["file", "contains"],
        "additionalProperties": false
      },
      "validationCommand": {
        "type": "array",
        "items": { "type": "string" },
        "description": "Single validation command (legacy format)"
      },
      "validationCommands": {
        "type": "array",
        "items": {
          "type": "array",
          "items": { "type": "string" }
        },
        "description": "Multiple validation commands (enhanced format)"
      }
    },
    "additionalProperties": false
  }